<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>研判详情</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <!-- basic styles -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../assets/css/font-awesome.min.css" />
    <link rel="stylesheet" href="../css/case.css" />
    <link rel="stylesheet" href="../css/report.css" />
    <!-- ace styles -->
    <link rel="stylesheet" href="../assets/css/ace.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/jquery.dataTables.min.css" />
    <script src="../assets/js/jquery-2.0.3.min.js"></script>
    <script src="../js/jquery.dataTables.min.js"></script>
    <script src="../assets/js/datepicker/WdatePicker.js"></script>
    <script src="../assets/js/ace-extra.min.js"></script>

    <!-- basic scripts -->
    <!-- <![endif]-->
    <script src="../assets/js/bootstrap.min.js"></script>
    <script src="../assets/js/typeahead-bs2.min.js"></script>

    <!-- ace scripts -->
    <script src="../assets/js/ace-elements.min.js"></script>
    <script src="../assets/js/ace.min.js"></script>
    <!-- page specific plugin scripts -->

    <script src="../assets/js/jquery.dataTables.bootstrap.js"></script>

    <!-- inline scripts related to this page -->
    <script src="../assets/js/layer/layer.js"></script>

    <script src="../js/common.js"></script>
    <link rel="stylesheet" href="../css/commonStyle.css" />
    <!-- select -->
    <style>
        .areaTxt{
            background: #fff!important;
            border: none;
        }
        .areaTxt_One{
            width: 99%;
            min-height: 95%;
            margin-top: 2px;
            margin-left: 4px;
            border: 1px solid #D1E1FF;
            resize: none;
        }
        .main-content{
            width: auto;
            height: auto;
            margin: 0;
            padding: 0px;
        }
    </style>
</head>
<body>
<!-- 上方头部 -->
<div class="main-container" id="main-container">
    <div class="main-container-inner">
        <!-- 右侧部分 -->
        <div class="main-content">
            <!--当前位置-->
            <div class="page-content">
                <div id="myTabContent" class="tab-content">
                    <div class="tab-pane fade in active" id="message" style="overflow: hidden;">
                        <!--查询条件-->
                        <!--<div class="row-container searchAll search-condition">-->
                        <!--&lt;!&ndash;举报人涉案&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle borderLnone">-->
                        <!--<p>-->
                        <!--举报人涉案:-->
                        <!--</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon ">-->
                        <!--<input type="text" class="form-control" placeholder="请输入举报人涉案">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;举报人涉警信息&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle ">-->
                        <!--<p>-->
                        <!--举报人涉警信息:-->
                        <!--</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon">-->
                        <!--<input type="text" class="form-control" placeholder="请输入举报人涉警信息">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;被举报人涉案&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle ">-->
                        <!--<p>-->
                        <!--被举报人涉案:-->
                        <!--</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon">-->
                        <!--<input type="text" class="form-control" placeholder="请输入被举报人涉案">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;被举报人涉警信息&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle borderLnone">-->
                        <!--<p>-->
                        <!--被举报人涉警信息:-->
                        <!--</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon">-->
                        <!--<input type="text" class="form-control" placeholder="被举报人涉警信息">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;结合线下或其他系统查证&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle">-->
                        <!--<p>其他系统查证:</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon">-->
                        <!--<input type="text" class="form-control" placeholder="请输入结合线下或其他系统查证">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;操作人&ndash;&gt;-->
                        <!--<div class="col-md-4">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-5 searchTitle">-->
                        <!--<p>-->
                        <!--操作人:-->
                        <!--</p>-->
                        <!--</div>-->
                        <!--<div class="col-md-7 searchCon">-->
                        <!--<input type="text" class="form-control" placeholder="请输入名称">-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--&lt;!&ndash;查询按钮&ndash;&gt;-->
                        <!--<div class="col-md-12 searchBtn" style="border:none;">-->
                        <!--<div class="row">-->
                        <!--<div class="col-md-12 ">-->
                        <!--<button class="btn btn-primary" type="button"> 查询 </button>-->
                        <!--<button class="btn btn-primary" type="button" onclick="reset()"> 重置 </button>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <div style="width: 100%;height: 100%;margin: 0 auto;margin:10px auto;background: white">
                            <!--案件基本信息录入-->
                            <div class="breadcrumbs" style="margin: 0;width: auto;height: auto;padding: 0px">
                                <!--案件信息录入-->
                                <!--案件信息录入-->
                                <div class="row breadcrumbs" style="text-align: center;margin: 0px;border-left: none;border-top: none;border-right: none">
                                    <div class="col-md-12">
                                        <span class="title">举报信息</span>
                                        <input type="hidden" id="tipoffId">
                                    </div>
                                </div>
                                <form action="">
                                    <!--举报人姓名、举报人电话、举报人身份证号-->
                                    <div class="row breadcrumbs caseContainer">
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>举报人姓名</span>
                                            </div>
                                            <div class="col-md-8 caseInput">
                                                <span id="tipoffReporter" class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>举报人电话</span>
                                            </div>
                                            <div class="col-md-8 caseInput">
                                                <span id="reporterPhone"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>举报人身份证号</span>
                                            </div>
                                            <div class="col-md-8 caseInput lastInput">
                                                <span  id="reporterIdcard"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                    </div>
                                    <!--被举报人姓名、被举报人电话、-->
                                    <div class="row breadcrumbs caseContainer">
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>被举报人姓名</span>
                                            </div>
                                            <div class="col-md-8 caseInput">
                                                <span  id="beingReported"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>被举报人电话</span>
                                            </div>
                                            <div class="col-md-8 caseInput">
                                                <span  id="beingReportedPhone"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>被举报人身份证号</span>
                                            </div>
                                            <div class="col-md-8 caseInput lastInput">
                                                <span id="beingReportedIdcard"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                    </div>
                                    <!--案件地域、涉案类别-->
                                    <div class="row breadcrumbs caseContainer">
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>案件地域</span>
                                            </div>
                                            <div class="col-md-8 caseInput">
                                                <span id="caseUnitName"   class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 noPadding">
                                            <div class="col-md-4 caseTxt">
                                                <span>涉案类别</span>
                                            </div>
                                            <div class="col-md-8 caseInput borderRnone">
                                                <span  id="caseClassName"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                            </div>
                                        </div>
                                        <!--当涉案类别选择其他时展示-->
                                        <div class="col-md-4 noPadding lastInput" style="background: white">
                                            <div class="col-md-8 caseInput borderRnone" style="margin-left: 30px">
                                                <input class="hint hidden" placeholder="  请输入其他涉案类别"/>
                                            </div>
                                        </div>
                                    </div>
                                    <!--线索标题-->
                                    <div class="row breadcrumbs caseContainer">
                                        <div class="col-md-2 caseTxt" style="width: 11.11%">
                                            <span>线索标题</span>
                                        </div>
                                        <div class="col-md-9 caseInput lastInput" style="width: 88.88%">
                                            <span id="clueTitle"  class="clowp" style="background-color: #fff!important;padding-left: 10px;" ></span>
                                        </div>
                                    </div>
                                    <!--简要案情-->
                                    <div class="row breadcrumbs caseContainer" style="min-height: 80px">
                                        <div class="col-md-2 caseTxt" style="width:11.11%;min-height: 80px;line-height: 80px">
                                            <span>线索内容</span>
                                        </div>
                                        <div class="col-md-10 caseInput lastInput" style="width:88.88%;min-height: 80px">
                                            <span id="clueContent"  class="areaTxt" type="text" style="resize: none;"></span>
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                        <div class="col-md-12" style="border:none;">
                            <div class="row">
                                <div class=" ">
                                    <button class="btn btn-primary" type="button" style="font-size:13px;float: left;padding: 2px 5px;border-radius: 4px" id="whistleblowers"> 举报人 </button>
                                    <button class="btn btn-primary" type="button" style="font-size:13px;float: left;margin-left: 8px;padding: 2px 5px;border-radius: 4px" id="report"> 被举报人 </button>
                                </div>
                            </div>
                        </div>
                        <div class="wt100"style="margin-top: 50px;">
                            <div class="row breadcrumbs" style="text-align: center;margin: 0px;border-left: none;border-top: none;border-right: none">
                                <div class="col-md-12">
                                    <span class="title">案件列表</span>
                                </div>
                            </div>
                            <table id="dynamic-table" class="cell-border table table-striped table-bordered table-hover dataTable"  cellspacing="0" width="100%">
                            </table>
                        </div>
                        <div class="wt100">
                            <div class="row breadcrumbs" style="text-align: center;margin: 0px;border-left: none;border-top: none;border-right: none">
                                <div class="col-md-12">
                                    <span class="title">警情列表</span>
                                </div>
                            </div>
                            <table id="dynamic-table_One" class="cell-border table table-striped table-bordered table-hover dataTable"  cellspacing="0" width="100%">
                            </table>
                        </div>
                        <div class="row breadcrumbs caseContainer" style="min-height: 80px;margin: 0;margin-top: 10px">
                            <div class="col-md-4 caseTxt" style="width:12%;min-height: 80px;line-height: 80px">
                                <span class="notNull">*</span>
                                <span>研判结论</span>
                            </div>
                            <div class="col-md-8 caseInput lastInput" style="width:88%;min-height: 80px">
                                <textarea class="areaTxt_One" type="text" id="conclusionOfTheStudy"></textarea>
                            </div>
                        </div>
                        <div class="col-md-12 searchBtn" style="border:none;">
                            <div class="row">
                                <div class="col-md-12 ">
                                    <button class="btn btn-primary" type="button" onclick="submit()"> 提交 </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(window).ready(function () {
        var  thisURL = document.URL;
        var  getval =thisURL.split('?')[1];
        var  tipoffId = getval.split("&")[0].split("=")[1];
        findList(tipoffId);
        $("#tipoffId").val(tipoffId);
        
    });
    function findList(tipoffId){
        $.ajax({
            type: 'post',
            url: getRootPath_web() + "reportHandler/findReportById?tipoffId="+tipoffId,//发送请求
            dataType : "json",
            success: function(data) {
                var json = $.parseJSON(data.data);
                var jsonObj = json.data.etTipoff;
                console.log(jsonObj);
                $("#tipoffReporter").text(jsonObj.tipoffReporter == null?"":jsonObj.tipoffReporter);
                $("#clueTitle").text(jsonObj.clueTitle== null?"":jsonObj.clueTitle);
                $("#reporterPhone").text(jsonObj.reporterPhone== null?"":jsonObj.reporterPhone);
                $("#reporterIdcard").text(jsonObj.reporterIdcard== null?"":jsonObj.reporterIdcard);
                $("#beingReported").text(jsonObj.beingReported== null?"":jsonObj.beingReported);
                $("#beingReportedPhone").text(jsonObj.beingReportedPhone== null?"":jsonObj.beingReportedPhone);
                $("#beingReportedIdcard").text(jsonObj.beingReportedIdcard== null?"":jsonObj.beingReportedIdcard);
                $("#caseClassName").text(jsonObj.caseClassName== null?"":jsonObj.caseClassName);
                $("#caseUnitName").text(jsonObj.caseUnitName== null?"":jsonObj.caseUnitName);
                $("#clueContent").text(jsonObj.clueContent== null?"":jsonObj.clueContent);
                $("#judgeContent").text(jsonObj.judgeContent== null?"":jsonObj.judgeContent);
                if($("#caseClass").val()==1916){
                    $("#caseClassMemo").attr('class','show');
                }else{
                    $("#caseClassMemo").attr('class','hide');
                }
                //
                //controlButtons(menuType,jsonObj.operateType);
                searchCaseList("2","","","",jsonObj.beingReported,jsonObj.beingReportedPhone,jsonObj.beingReportedIdcard);
                dynamictableSearch("2","","","",jsonObj.beingReported,jsonObj.beingReportedPhone,jsonObj.beingReportedIdcard);
            }
        });
      
    }
    
    function controlButtons(menuType,tipoffStatus){
        console.log('menuType is ' + menuType +'  tipoffStatus is '+tipoffStatus)
        if(menuType == 2){
            if(tipoffStatus == 1){
                $("#btn_sh").show();
            }
            else if(tipoffStatus == 2){
                $("#btn_xf").show();
            }
        }else if(menuType == 3){
            if(tipoffStatus == 3){
                $("#btn_qs").show();
            }else if(tipoffStatus == 4){
                $("#btn_yp").show();
            }
        }else if(menuType == 4){
            if(tipoffStatus == 5)
                $("#btn_fs").show();
        }
    }


    //案件列表
    var dynamictable;

    function searchCaseList(reprotType,tipoffReporter,reporterPhone,reporterIdcard,beingReported,beingReportedPhone,beingReportedIdcard) {
        $("#dynamic-table_filter").css('display', 'block');
        dynamictable = $("#dynamic-table").DataTable(
            {
                "bLengthChange" : false, /* 去掉每页显示多少条数据方法 */
                "processing" : true,/*控制是否在数据加载时出现”Processing”的提示,一般在远程加载并且比较慢的情况下才会出现. 样式需要定义,否则比较丑.*/
                "pageLength" : 5,/*默认*/
                "lengthMenu" : [ [ 5, 10, 20, -1 ],
                    [ 5, 10, 20, "全部" ] ],
                /*"deferRender": true,*/
                "searching" : false,/*控制控件的搜索功能,如果为false,控件的搜索功能被完全禁用,而且默认搜索组件会被隐藏.*/
                "serverSide" : true,/* 启用服务器端分页,当设为true时,列表的过滤,搜索和排序信息会传递到Server端进行处理,实现真翻页方案的必需属性.反之,所有的列表功能都在客户端计算并执行*/
                "autoWidth" : false,/*用来启用或禁用自动列的宽度计算。通常被禁用作为优化（它需要一个有限的时间量来计算的宽度），默认值是true，所以通常将它设为false*/
                /*  "order": [   //表示先对第1列进行升序排序，再按照第二列升序排序，最后按照第三列降序排序
                 [0, "desc"]
                 ], */
                //因为需要多次初始化，所以需要设置允许销毁实例
                "destroy" : true,
                "bFilter" : false,
                "orderMulti" : false, //启用多列排序
                "order" : [], //取消默认排序查询,否则复选框一列会出现小箭头
                /* "pagingType": "full_numbers", *///分页样式：simple,simple_numbers,full,full_numbers
                /*   "table-layout":fix, */
                "row-border" : true,
                "oLanguage" : {
                    "sEmptyTable" : "没有记录",
                    "sProcessing" : "处理中，请稍候...",
                    "sLengthMenu" : "每页显示 _MENU_ 条记录",
                    "sZeroRecords" : "没有记录",
                    "sInfo" : " _START_ 到  _END_ 条记录,总记录数为 _TOTAL_ 条",
                    "sInfoEmpty" : "记录数为0",
                    "sInfoFiltered" : "(从全部记录数 _MAX_ 条中过滤)",
                    "sInfoPostFix" : "",
                    "sLoadingRecords" : "正在加载中,请稍候...",
                    "sSearch" : "搜索",
                    "sUrl" : "",
                    "oPaginate" : {
                        "sFirst" : "首页",
                        "sPrevious" : "上一页",
                        "sNext" : "下一页",
                        "sLast" : "末页"
                    }
                },
                ajax : {
                    url : getRootPath_web()+"reportHandler/findCaseInfo",
                    "data":{
                        reprotType:reprotType,
                        tipoffReporter:tipoffReporter,
                        reporterPhone:reporterPhone,
                        reporterIdcard:reporterIdcard,
                        beingReported:beingReported,
                        beingReportedPhone:beingReportedPhone,
                        beingReportedIdcard:beingReportedIdcard
                    },
                    "type" : "post"
                },
                /*序号自增长*/
                "fnDrawCallback" : function(){
                    this.api().column(0).nodes().each(function(cell, i) {
                        cell.innerHTML =  i + 1;
                    });
                },
                "bDeferRender" : true,/*是否启用延迟加载：当你使用AJAX数据源时，可以提升速度。*/
                "columns": [
                    {"sTitle":'<font>序号</font>','sWidth' :'5%',"sClass" :"dt-left", 'bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>案件编号</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'caseNo','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>案件名称</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'caseTitle','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>发案时间</font>',"sWidth":"8%","sClass":"dt-left", 'data': 'happenTimeUp','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data.substring(0,data.indexOf("."));
                        }},
                    {"sTitle":'<font>案件类别</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'caseClass','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return dicCommon[19][data];
                        }},
                    {"sTitle":'<font>案件状态</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'caseState','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return dicCommon[18][data];
                        }},
                    {"sTitle":'<font>受理单位</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'acceptUnitName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>录入人</font>',"sWidth":"6%","sClass":"dt-left", 'data': 'inputerName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>录入单位</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'inputUnitName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>区域划分</font>',"sWidth":"7%","sClass":"dt-left", 'data': 'zoneName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>录入时间</font>',"sWidth":"8%","sClass":"dt-left", 'data': 'creatTime','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }}
                ],
                "columnDefs": [{"sTitle":'<font>操作</font>',
                    "sWidth":"17%",
                    "data": "anjianId",
                    "sClass" : "dt-left",//字体居中dt-center
                    'targets': [11],
                    'render': function(data, type, row, meta) {
                        var data="'"+data+"'";
//								var caseNo="'"+row.caseNo+"'";
                        var html='<a href="#" class="operation" onclick="alertDetailANJIAN('+data+')">详情</a>';
                        return html;
                    },
                    'bSortable': false
                }]
            });
        $("#dynamic-table_filter").css("display", "none");
    }
    //录入弹框
    function alertAdd() {
        var name='案件录入';
        var url=projectPath+'/view/case/caseEditLayer.html';
        var width='90%';
        var high='90%';
        var callback=function (){
//                    layer.msg("案件录入成功！", {icon: 1,time:3000});
            findSelect('my_caseForm');
        };
        //弹框
        window.parent.Layer.layOpen(name,url,width,high,callback);
    }
    //详情弹框
    function alertDetailANJIAN(id) {
        var name='案件详情';
        var url=projectPath+'/view/case/caseDetailLayer.html?id='+id;
        var width='90%';
        var high='90%';
        var callback=function (){
        };
        //弹框
        window.parent.Layer.layOpen(name,url,width,high,callback);
        logEntry("2","案件信息管理 查看案件ID为："+id+"详情");
    }
    //警情列表
    var dynamictableOne;
    $(document).ready(function() {
        /* searchCaseList("","","","","","","");
        dynamictableSearch("","","","","","",""); */
        //selectDicUnit("unitCode");
        //录入单位
        $.ajax({
            type : 'POST',
            url : getRootPath_web() + "dic/findDicUnit?isInputUnit=1", //发送请求
            cache : false,
            async : false,
            dataType : "json",
            success : function(data) {
                $("#unitCode").html(data.html)
            }
        });
    });

    //列表部分
    function dynamictableSearch(reprotType,tipoffReporter,reporterPhone,reporterIdcard,beingReported,beingReportedPhone,beingReportedIdcard) {
        $("#dynamic-table_filter").css('display', 'block');
        dynamictableOne = $("#dynamic-table_One").DataTable(
            {
                "bLengthChange" : false, /* 去掉每页显示多少条数据方法 */
                "processing" : true,/*控制是否在数据加载时出现”Processing”的提示,一般在远程加载并且比较慢的情况下才会出现. 样式需要定义,否则比较丑.*/
                "pageLength" : 5,/*默认*/
                "lengthMenu" : [ [ 5, 10, 20, -1 ],
                    [ 5, 10, 20, "全部" ] ],
                /*"deferRender": true,*/
                "searching" : false,/*控制控件的搜索功能,如果为false,控件的搜索功能被完全禁用,而且默认搜索组件会被隐藏.*/
                "serverSide" : true,/* 启用服务器端分页,当设为true时,列表的过滤,搜索和排序信息会传递到Server端进行处理,实现真翻页方案的必需属性.反之,所有的列表功能都在客户端计算并执行*/
                "autoWidth" : false,/*用来启用或禁用自动列的宽度计算。通常被禁用作为优化（它需要一个有限的时间量来计算的宽度），默认值是true，所以通常将它设为false*/
                /*  "order": [   //表示先对第1列进行升序排序，再按照第二列升序排序，最后按照第三列降序排序
                 [0, "desc"]
                 ], */
                //因为需要多次初始化，所以需要设置允许销毁实例
                "destroy" : true,
                "bFilter" : false,
                "orderMulti" : false, //启用多列排序
                "order" : [], //取消默认排序查询,否则复选框一列会出现小箭头
                /* "pagingType": "full_numbers", *///分页样式：simple,simple_numbers,full,full_numbers
                /*   "table-layout":fix, */
                "row-border" : true,
                "oLanguage" : {
                    "sEmptyTable" : "没有记录",
                    "sProcessing" : "处理中，请稍候...",
                    "sLengthMenu" : "每页显示 _MENU_ 条记录",
                    "sZeroRecords" : "没有记录",
                    "sInfo" : " _START_ 到  _END_ 条记录,总记录数为 _TOTAL_ 条",
                    "sInfoEmpty" : "记录数为0",
                    "sInfoFiltered" : "(从全部记录数 _MAX_ 条中过滤)",
                    "sInfoPostFix" : "",
                    "sLoadingRecords" : "正在加载中,请稍候...",
                    "sSearch" : "搜索",
                    "sUrl" : "",
                    "oPaginate" : {
                        "sFirst" : "首页",
                        "sPrevious" : "上一页",
                        "sNext" : "下一页",
                        "sLast" : "末页"
                    }
                },
                ajax : {
                    url : getRootPath_web()+"reportHandler/findJingQingInfo",
                    "type" : "post",
                    "data":{
                        reprotType:reprotType,
                        tipoffReporter:tipoffReporter,
                        reporterPhone:reporterPhone,
                        reporterIdcard:reporterIdcard,
                        beingReported:beingReported,
                        beingReportedPhone:beingReportedPhone,
                        beingReportedIdcard:beingReportedIdcard
                    },
                    async:true
                },
                /*序号自增长*/
                "fnDrawCallback" : function(){
                    this.api().column(0).nodes().each(function(cell, i) {
                        cell.innerHTML =  i + 1;
                    });
                },
                "bDeferRender" : true,/*是否启用延迟加载：当你使用AJAX数据源时，可以提升速度。*/
                "columns": [
                    {"sTitle":'<font>序号</font>','sWidth' :'10%',"sClass" :"dt-left", 'bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>接警编号</font>',"sWidth":"15%","sClass":"dt-left", 'data': 'alarmNo','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>接警单位名称</font>',"sWidth":"15%","sClass":"dt-left", 'data': 'unitName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>警情分类</font>',"sWidth":"10%","sClass":"dt-left", 'data': 'alarmClassName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>发案地点</font>',"sWidth":"15%","sClass":"dt-left", 'data': 'locationCase','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return "<span style='width: 150px;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;'>"+data+"</span>";
                        }},
                    {"sTitle":'<font>报警人姓名</font>',"sWidth":"10%","sClass":"dt-left", 'data': 'alarmPersonName','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }},
                    {"sTitle":'<font>报警人联系电话</font>',"sWidth":"10%","sClass":"dt-left", 'data': 'alarmPersonPhone','bSortable': false,
                        'render': function(data, type, row, meta) {
                            if(data==""||data==null){
                                return "--";
                            }
                            return data;
                        }}
                ],
                "columnDefs": [{"sTitle":'<font>操作</font>',
                    "sWidth":"15%",
                    "data": "alarmNo", 
                    "sClass" : "dt-left",//字体居中dt-center
                    'targets': [7],
                    'render': function(data, type, row, meta) {
                    	  var data="'"+data+"'";
                        return  '<a href="#" class="operation" onclick="alertDetail('+data+')">详情</a>';
                    },
                    'bSortable': false
                }]
            });
        //logEntry("1","警情查询");
        $("#dynamic-table_filter").css("display", "none");
    }
    //举报人
    $(document).on("click", "#whistleblowers",
        function() {
            var tipoffReporter = $("#tipoffReporter").text();
            var reporterPhone =  $("#reporterPhone").text();
            var reporterIdcard = $("#reporterIdcard").text();
            searchCaseList("1",tipoffReporter,reporterPhone,reporterIdcard,"","","");
            dynamictableSearch("1",tipoffReporter,reporterPhone,reporterIdcard,"","","");
        });
    //被举报人
    $(document).on("click", "#report",
        function() {
            var beingReported = $("#beingReported").text();
            var beingReportedPhone =  $("#beingReportedPhone").text();
            var beingReportedIdcard = $("#beingReportedIdcard").text();
            searchCaseList("2","","","",beingReported,beingReportedPhone,beingReportedIdcard);
            dynamictableSearch("2","","","",beingReported,beingReportedPhone,beingReportedIdcard);
        });

    //录入弹框
    function alertAdd() {
        var ii;
        ii = layer.ready(function () {
            ii = layer.open({
                offset: 20,
                type: 2,
                title: '警情录入',
                fix: false,
                maxmin: true,
                shadeClose: true,
                area: ['1000px', '500px'],
                content: 'alarmInsertLayer.html',
                end: function () {
                    $('#form-dialogdsss').attr("style", "display:none");
                    location.reload();
                }
            });
        }).index;
    }
    //详情弹框
    function alertDetail(alarmNo) {
        var ii;
        ii = layer.ready(function () {
            ii = layer.open({
                offset: 20,
                type: 2,
                title: '警情详情',
                fix: false,
                maxmin: true,
                shadeClose: true,
                area: ['1000px', '500px'],
                content: '../alarm/alarmDetailLayer.html?alarmNo='+alarmNo,
                end: function () {
                    $('#form-dialogdsss').attr("style", "display:none");
                }
            });
        }).index;
    }
    //编辑弹框
    function searchAlarm(){
        var alarmTime=$("#alarmTime").val();
        var unitCode=$("#unitCode").val()==""?"":$("#unitCode").find("option:selected").val();
        var alarmPersonName=$("#alarmPersonName").val();
        var alarmPersonPhone=$("#alarmPersonPhone").val();
        dynamictableSearch(alarmTime,unitCode,alarmPersonName,alarmPersonPhone);
    }
    function submit() {
        $.ajax({
            url:getRootPath_web() + "reportHandler/etTipoffUpdate",
            type:"post",
            dataType:"json",
            data:{
                operationSign:5,//研判
                remark:$("#conclusionOfTheStudy").val(),
                tipoffId:$("#tipoffId").val()
            },
            success:function(json){
                /* parent.layer.msg(obj, {icon: 1,time:1000});
                setTimeout(function () {
                    layer.close(index);
                },1000); */
            	window.parent.parent.location.reload();
            },
            error:function(json){

            }
        })

        /*  if(){
            alert("研审提交成功") ;
         }else{

            alert("研审提交失败") ;
         } */
    }

</script>
</body>
</html>